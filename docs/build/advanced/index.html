<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · FLOWVPM.jl</title><meta name="title" content="Advanced Usage · FLOWVPM.jl"/><meta property="og:title" content="Advanced Usage · FLOWVPM.jl"/><meta property="twitter:title" content="Advanced Usage · FLOWVPM.jl"/><meta name="description" content="Documentation for FLOWVPM.jl."/><meta property="og:description" content="Documentation for FLOWVPM.jl."/><meta property="twitter:description" content="Documentation for FLOWVPM.jl."/><meta property="og:url" content="https://flow.byu.edu/FLOWVPM/advanced/"/><meta property="twitter:url" content="https://flow.byu.edu/FLOWVPM/advanced/"/><link rel="canonical" href="https://flow.byu.edu/FLOWVPM/advanced/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FLOWVPM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../guided/">Guided Examples</a></li><li class="is-active"><a class="tocitem" href>Advanced Usage</a><ul class="internal"><li><a class="tocitem" href="#Accessing-the-ParticleField"><span>Accessing the ParticleField</span></a></li><li><a class="tocitem" href="#Particle-Field-Settings"><span>Particle Field Settings</span></a></li><li><a class="tocitem" href="#Code-Integration"><span>Code Integration</span></a></li></ul></li><li><a class="tocitem" href="../rVPM/">Theory</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Advanced Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/FLOWVPM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/FLOWVPM.jl/blob/main/docs/src/advanced.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Usage"><a class="docs-heading-anchor" href="#Advanced-Usage">Advanced Usage</a><a id="Advanced-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Usage" title="Permalink"></a></h1><p>For more advanced examples please see the examples folder.</p><h2 id="Accessing-the-ParticleField"><a class="docs-heading-anchor" href="#Accessing-the-ParticleField">Accessing the ParticleField</a><a id="Accessing-the-ParticleField-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-the-ParticleField" title="Permalink"></a></h2><p><code>FLOWVPM</code> provides getter and setter functions for particles. Getter functions take the form <code>get_property(P)</code> where <code>P</code> is a particle, or <code>get_property(pfield::ParticleField, i::Int)</code> where <code>i</code> is the particle index. Getter functions return views. Setter functions take the from <code>set_property(P, val)</code> and <code>set_property(pfield, i, val)</code> where <code>val</code> is the new value to be set and is applied via broadcasting. Getter and setter functions are used by replacing &quot;property&quot; with the desired particle property such as <code>get_X(P)</code>. The following are the particle properties: </p><ul><li><code>X</code>: position</li><li><code>Gamma</code>: vortex strength</li><li><code>sigma</code>: radius</li><li><code>vol</code>: volume</li><li><code>circulation</code>: circulation</li><li><code>U</code>: velocity</li><li><code>vorticity</code>: vorticity </li><li><code>J</code>: velocity gradient</li><li><code>M</code>: auxiliary computational storage</li><li><code>C</code>: SFS model parameters</li><li><code>static</code>: tag indicating whether this particle&#39;s states should evolve in time or not (sometimes used to represent solid bodies)</li><li><code>PSE</code>: Storage needed for <code>ParticleStrengthExchange</code></li><li><code>SFS</code>: Storage of SFS values</li></ul><h2 id="Particle-Field-Settings"><a class="docs-heading-anchor" href="#Particle-Field-Settings">Particle Field Settings</a><a id="Particle-Field-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Field-Settings" title="Permalink"></a></h2><p>Here we provide details on all relevant keyword setting for a <code>ParticleField</code>.</p><h3 id="formulation"><a class="docs-heading-anchor" href="#formulation">formulation</a><a id="formulation-1"></a><a class="docs-heading-anchor-permalink" href="#formulation" title="Permalink"></a></h3><p>The VPM formulation to be used</p><ul><li><a href="../reference/#FLOWVPM.rVPM"><code>rVPM</code></a>: The reformulated VPM equations (default).</li><li><a href="../reference/#FLOWVPM.cVPM"><code>cVPM</code></a>: The classic VPM equations.</li><li><a href="../reference/#FLOWVPM.formulation_tube_continuity"><code>formulation_tube_continuity</code></a>: VPM equations derived from tube conservation of mass.</li><li><a href="../reference/#FLOWVPM.formulation_tube_momentum"><code>formulation_tube_momentum</code></a>: VPM equations derived from tube conservation of momentum.</li></ul><h3 id="viscous"><a class="docs-heading-anchor" href="#viscous">viscous</a><a id="viscous-1"></a><a class="docs-heading-anchor-permalink" href="#viscous" title="Permalink"></a></h3><p>The viscous model used when propagating particles. Generally, aerodynamic simulations do not require viscous modeling.</p><ul><li><a href="../reference/#FLOWVPM.Inviscid"><code>Inviscid</code></a>: Uses no viscous modeling for the particles (default).</li><li><a href="../reference/#FLOWVPM.CoreSpreading"><code>CoreSpreading</code></a>: Uses a core spreading viscous model in which particles grow in size at each step. After a defined amount of time the particle size is reset and the particle strength recalculated to maintain the vorticity field strength.</li><li><a href="../reference/#FLOWVPM.ParticleStrengthExchange"><code>ParticleStrengthExchange</code></a>: Uses particle strength exchange to simulate viscosity.</li></ul><h3 id="kernel"><a class="docs-heading-anchor" href="#kernel">kernel</a><a id="kernel-1"></a><a class="docs-heading-anchor-permalink" href="#kernel" title="Permalink"></a></h3><p>Describes how vorticity is distributed by the vortex particles.</p><ul><li><a href="../reference/#FLOWVPM.singular"><code>singular</code></a>: Singular vortex kernel.</li><li><a href="../reference/#FLOWVPM.gaussian"><code>gaussian</code></a>: Gaussian vortex kernel.</li><li><a href="../reference/#FLOWVPM.gaussianerf"><code>gaussianerf</code></a>: Gaussian error function vortex kernel (default).</li><li><a href="../reference/#FLOWVPM.winckelmans"><code>winckelmans</code></a>: Winckelman vortex kernel</li></ul><h3 id="UJ"><a class="docs-heading-anchor" href="#UJ">UJ</a><a id="UJ-1"></a><a class="docs-heading-anchor-permalink" href="#UJ" title="Permalink"></a></h3><p>Determines how the n-body particle interaction is solved. Users can provide custom UJ functions if desired.</p><ul><li><a href="../reference/#FLOWVPM.UJ_fmm"><code>UJ_fmm</code></a>: Uses the fast multipole method to solve the n-body problem (default).</li><li><a href="../reference/#FLOWVPM.UJ_direct-Tuple{ParticleField}"><code>UJ_direct</code></a>: Loops through all particle interactions directly.</li></ul><h3 id="Uinf"><a class="docs-heading-anchor" href="#Uinf">Uinf</a><a id="Uinf-1"></a><a class="docs-heading-anchor-permalink" href="#Uinf" title="Permalink"></a></h3><p>The freestream fluid velocity. Defaults to <code>SVector{3,Float64}(0,0,0)</code>.</p><h3 id="SFS"><a class="docs-heading-anchor" href="#SFS">SFS</a><a id="SFS-1"></a><a class="docs-heading-anchor-permalink" href="#SFS" title="Permalink"></a></h3><p>The subfilter-scale (SFS) model used in the reformulated VPM equations. The SFS model simulated the turbulent energy cascade. For simulations with little turbulence the model may be unnecessary. Custom modifications can be made, setting the coefficient or the alpha used is possible.</p><ul><li><a href="../reference/#FLOWVPM.noSFS"><code>noSFS</code></a>: No SFS model is used (default).</li><li><a href="../reference/#FLOWVPM.SFS_Cs_nobackscatter"><code>SFS_Cs_nobackscatter</code></a>: Uses a constant coefficient for the SFS model.</li><li><a href="../reference/#FLOWVPM.SFS_Cd_twolevel_nobackscatter"><code>SFS_Cd_twolevel_nobackscatter</code></a>: Uses a dynamic coefficient for the SFS model. Sets <code>alpha=0.999</code>. Recommended for high fidelity modeling.</li><li><a href="../reference/#FLOWVPM.SFS_Cd_threelevel_nobackscatter"><code>SFS_Cd_threelevel_nobackscatter</code></a>: Uses a dynamic coefficient for the SFS model. Sets <code>alpha=0.667</code>, which reduces the effect of the SFS significantly.</li></ul><h3 id="integration"><a class="docs-heading-anchor" href="#integration">integration</a><a id="integration-1"></a><a class="docs-heading-anchor-permalink" href="#integration" title="Permalink"></a></h3><p>The time integration scheme used in propogating particles</p><ul><li><a href="../reference/#FLOWVPM.euler"><code>euler</code></a>: Uses an euler time stepping scheme.</li><li><a href="../reference/#FLOWVPM.rungekutta3"><code>rungekutta3</code></a>: Uses a low storage RK3 time stepping scheme (default).</li></ul><h3 id="transposed"><a class="docs-heading-anchor" href="#transposed">transposed</a><a id="transposed-1"></a><a class="docs-heading-anchor-permalink" href="#transposed" title="Permalink"></a></h3><p>Determines how the stretching term is stored. Defaults to <code>true</code>. There is no need for users to modify this value.</p><h3 id="relaxation"><a class="docs-heading-anchor" href="#relaxation">relaxation</a><a id="relaxation-1"></a><a class="docs-heading-anchor-permalink" href="#relaxation" title="Permalink"></a></h3><p>To avoid numerical instability the particles are relaxed in order to ensure the field is divergence free.</p><ul><li><a href="../reference/#FLOWVPM.norelaxation"><code>norelaxation</code></a>: Does not relax the particles.</li><li><a href="../reference/#FLOWVPM.pedrizzetti"><code>pedrizzetti</code></a>: Relaxation scheme where the vortex strength is aligned with the local vorticity. (default).</li><li><a href="../reference/#FLOWVPM.correctedpedrizzetti"><code>correctedpedrizzetti</code></a>: Relaxation scheme where the vortex strength is aligned with the local vorticity. This version fixes the error in Pedrizzetti&#39;s relaxation that made the strength</li></ul><p>to continually decrease over time.</p><h3 id="fmm"><a class="docs-heading-anchor" href="#fmm">fmm</a><a id="fmm-1"></a><a class="docs-heading-anchor-permalink" href="#fmm" title="Permalink"></a></h3><p>Settings for the fast multipole solver. Defaults autotune the FMM so that the absolute and relative tolerance of the velocity calculations are within 1e-3. See the the API for detailed settings</p><ul><li><a href="../reference/#FLOWVPM.FMM"><code>FMM</code></a></li></ul><h3 id="useGPU"><a class="docs-heading-anchor" href="#useGPU">useGPU</a><a id="useGPU-1"></a><a class="docs-heading-anchor-permalink" href="#useGPU" title="Permalink"></a></h3><p>Determines whether or not to use GPU acceleration to solve the n-body problem. Defaults to CPU usage. Still experimental and does not work on SFS calculation, only works on NVIDIA GPUs. To allow GPU usage set to values greater than 0.</p><h2 id="Code-Integration"><a class="docs-heading-anchor" href="#Code-Integration">Code Integration</a><a id="Code-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Code-Integration" title="Permalink"></a></h2><p>For examples of integrating FLOWVPM into other codes please see <a href="https://github.com/byuflowlab/FLOWUnsteady">FLOWUnsteady</a> and <a href="https://github.com/byuflowlab/VortexLattice">VortexLattice</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../guided/">« Guided Examples</a><a class="docs-footer-nextpage" href="../rVPM/">Theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 5 August 2025 10:59">Tuesday 5 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
