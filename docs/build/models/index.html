<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ParticleField · FLOWVPM.jl</title><meta name="title" content="ParticleField · FLOWVPM.jl"/><meta property="og:title" content="ParticleField · FLOWVPM.jl"/><meta property="twitter:title" content="ParticleField · FLOWVPM.jl"/><meta name="description" content="Documentation for FLOWVPM.jl."/><meta property="og:description" content="Documentation for FLOWVPM.jl."/><meta property="twitter:description" content="Documentation for FLOWVPM.jl."/><meta property="og:url" content="https://flow.byu.edu/FLOWVPM/models/"/><meta property="twitter:url" content="https://flow.byu.edu/FLOWVPM/models/"/><link rel="canonical" href="https://flow.byu.edu/FLOWVPM/models/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FLOWVPM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../advanced/">Advanced Usage</a></li><li><a class="tocitem" href="../rVPM/">Theory</a></li><li><a class="tocitem" href="../api/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ParticleField</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ParticleField</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/FLOWVPM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/FLOWVPM.jl/blob/main/docs/src/models.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ParticleField"><a class="docs-heading-anchor" href="#ParticleField">ParticleField</a><a id="ParticleField-1"></a><a class="docs-heading-anchor-permalink" href="#ParticleField" title="Permalink"></a></h1><p>FLOWVPM is centered around the ParticleField struct that contains all of the particle information and model settings.</p><p><code>ParticleField(maxparticles)</code></p><p><code>maxparticles</code> is the maximum number of particles that can exist in the simulation. The memory for these particles is allocated at the time the <code>ParticleField</code> is created, so any attempt to add more than <code>maxparticles</code> particles will result in errors</p><h2 id="Keyword-Arguments"><a class="docs-heading-anchor" href="#Keyword-Arguments">Keyword Arguments</a><a id="Keyword-Arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Keyword-Arguments" title="Permalink"></a></h2><p><code>formulation</code>: VPM formulation. See Model Options for more details</p><p><code>viscous</code>: Viscous scheme. With classic VPM viscous schemes help improve numerical stability, with the reformulated VPM they are not necessary unless significant viscosity actually exists. &lt;!– I would say this uses a core spreading viscosity model via operator splitting to simulate fluid viscosity. I like the note that it&#39;s not needed for numerical stability –&gt;</p><p><code>np</code>: The number of particles in the field, defaults to 0 and is modifed by the <code>add_particle</code> and <code>remove_particle</code> functions.</p><p><code>nt</code>: The current time step number. Defaults to 0.</p><p><code>t</code>: Current time. Defaults to 0.0.</p><p><code>transposed</code>: Determines how the vortex stretching is stored. Defaults to <code>true</code>. (There is no need for the user to modify this value.) &lt;!– this actually refers to how the (v \cdot \nabla) \omega operator is implemented in code, and doesn&#39;t affect how stretching is stored; the transposed scheme has been recommended for stability –&gt;</p><p><code>fmm</code>: FMM settings. Defaults to <code>FMM(; p=4, ncrit=50, theta=0.4, nonzero_sigma=true, ε_tol=nothing)</code>. <code>p</code> is the maximum order of the multipole expansion, higher values result in higher accuracy. <code>ncrit</code> is the maximum leaf size. <code>theta</code> is the multipole acceptance criterion. <code>nonzero_sigma</code> improves the accuracy of the FMM when bodies have finite radius (should always be true as vortex particles have a nonzero radius). <code>ε_tol</code> (varepsilon) is the maximum absolute error allowed in the FMM calculations, by setting this value, the FMM dynamically sets the expansion order to satsify this error tolerance. See <code>Fastmultipole.jl</code> for more details.</p><p><code>M</code>: Auxiliary storage for particle computations; users should never modify the default.</p><p><code>toggle_rbf</code>: Switch to determine if the vorticity field should be calculated. This value changes frequently during time steps and should never be modified by users.</p><p><code>toggle_sfs</code>: Switch to determine if the stretching term should be calculated. This value changes frequently during time steps and should never be modified by users.</p><p><code>SFS</code>: The subfilter-scale scheme used. See Model Options for details.</p><p><code>kernel</code>: The vortex particle kernel. See Model Options for details.</p><p><code>UJ</code>: If set to UJ<em>fmm (default) uses the FMM to solve the particle interactions in O(n) time. If set to UJ</em>direct uses only direct calculations so solve for particle interactions in O(n^2) time. Unless debugging or checking for error produced by the FMM settings there is no need to use UJ_direct.</p><p><code>Uinf</code>: Freestream velocity, takes the form <code>f(t)</code> where <code>t</code> is the current time.</p><p><code>relaxation</code>: The divergence relaxation scheme, see Model Options for more details.</p><p><code>integration</code>: Time integration scheme. Defaults to an RK3 method.</p><p><code>useGPU</code>: Defaults to 0, still experimental. Uses CUDA to accelerate SFS calculations.</p><h2 id="Accessing-Particle-Information"><a class="docs-heading-anchor" href="#Accessing-Particle-Information">Accessing Particle Information</a><a id="Accessing-Particle-Information-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Particle-Information" title="Permalink"></a></h2><p><code>FLOWVPM</code> provides getter and setter functions for particles. Getter functions take the form <code>get_property(P)</code> where <code>P</code> is a particle, or <code>get_property(pfield::ParticleField, i::Int)</code> where <code>i</code> is the particle index. Getter functions return views. Setter functions take the from <code>set_property(P, val)</code> and <code>set_property(pfield, i, val)</code> where <code>val</code> is the new value to be set and is applied via broadcasting. Getter and setter functions are used by replacing &quot;property&quot; with the desired particle property such as <code>get_X(P)</code>. The following are the particle properties: </p><ul><li><code>X</code>: position</li><li><code>Gamma</code>: vortex strength</li><li><code>sigma</code>: radius</li><li><code>vol</code>: volume</li><li><code>circulation</code>: circulation</li><li><code>U</code>: velocity</li><li><code>vorticity</code>: vorticity </li><li><code>J</code>: velocity gradient</li><li><code>M</code>: auxiliary computational storage</li><li><code>C</code>: SFS model parameters</li><li><code>static</code>: tag indicating whether this particle&#39;s states should evolve in time or not (sometimes used to represent solid bodies)</li><li><code>PSE</code>: Storage needed for <code>ParticleStrengthExchange</code></li><li><code>SFS</code>: Storage of SFS values</li></ul><h2 id="Adding-Particles-to-the-ParticleField"><a class="docs-heading-anchor" href="#Adding-Particles-to-the-ParticleField">Adding Particles to the ParticleField</a><a id="Adding-Particles-to-the-ParticleField-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-Particles-to-the-ParticleField" title="Permalink"></a></h2><p>Calling <code>add_particle(pfield::ParticleField, X, Gamma, sigma)</code> will add a particle to the particle field with position <code>X</code>, circulation <code>Gamma</code>, and radius <code>sigma</code>. The function will error if <code>pfield.maxparticles</code> is exceeded. Another option is to call <code>add_particle(pfield, P)</code> where <code>P</code> is a particle.</p><h2 id="Removing-Particles-from-the-ParticleField"><a class="docs-heading-anchor" href="#Removing-Particles-from-the-ParticleField">Removing Particles from the ParticleField</a><a id="Removing-Particles-from-the-ParticleField-1"></a><a class="docs-heading-anchor-permalink" href="#Removing-Particles-from-the-ParticleField" title="Permalink"></a></h2><p>Calling <code>remove_particle(pfield::ParticleField, i:Int)</code> will remove particle <code>i</code> from <code>pfield</code>.</p><h2 id="Propogating-Particles"><a class="docs-heading-anchor" href="#Propogating-Particles">Propogating Particles</a><a id="Propogating-Particles-1"></a><a class="docs-heading-anchor-permalink" href="#Propogating-Particles" title="Permalink"></a></h2><p>Calling <code>nextstep(pfield::ParticleField, dt::Real; relax=false, custom_UJ=nothing)</code> will propogate the particles in <code>pfield</code> forward <code>dt</code> in time. <code>relax</code> can be used to set relaxation to only occur under certain conditions. <code>custom_UJ</code> can be set if the user wishes to calculate the induced velocity and velocity gradient manually.</p><p>run_vpm!</p><h2 id="Model-Options"><a class="docs-heading-anchor" href="#Model-Options">Model Options</a><a id="Model-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Options" title="Permalink"></a></h2><p>For details on models please see:</p><p>Alvarez, Eduardo J., &quot;Reformulated Vortex Particle Method and Meshless Large Eddy Simulation of Multirotor Aircraft&quot; (2022). Theses and Dissertations. 9589. https://scholarsarchive.byu.edu/etd/9589</p><h3 id="VPM-Fomulation"><a class="docs-heading-anchor" href="#VPM-Fomulation">VPM Fomulation</a><a id="VPM-Fomulation-1"></a><a class="docs-heading-anchor-permalink" href="#VPM-Fomulation" title="Permalink"></a></h3><p>All VPM formulations use the same basic equations with varying coefficients <span>$f$</span> and <span>$g$</span> as defined in \cite{}.</p><ul><li><code>rVPM</code> enforces conservation of mass and momentum for a spherical fluid element and is the default formulation (<span>$f=0$</span>, <span>$g=1/5$</span>)</li><li><code>cVPM</code> refers to the classic VPM equation, and enforces neither conservation of mass nor momentum (<span>$f=g=0$</span>)</li><li><code>formulation_tube_continuity</code> enforces conservation of mass for a vortex tube (<span>$f=1/2$</span>, <span>$g=0$</span>)</li><li><code>formulation_tube_momentum</code> enforces conservation of angular momentum for a vortex tube (<span>$f=1/4$</span>, <span>$g=1/4$</span>)</li></ul><h3 id="Kernels"><a class="docs-heading-anchor" href="#Kernels">Kernels</a><a id="Kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Kernels" title="Permalink"></a></h3><ul><li><code>singular</code></li><li><code>gaussian</code></li><li><code>gaussianerf</code> (default)</li><li><code>winckelmans</code></li></ul><h3 id="Relaxation-Schemes"><a class="docs-heading-anchor" href="#Relaxation-Schemes">Relaxation Schemes</a><a id="Relaxation-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Relaxation-Schemes" title="Permalink"></a></h3><p>These relaxation schemes are designed to enforce a divergence free velocity field and improves numerical stability</p><ul><li><code>norelaxation</code></li><li><code>pedrizzetti</code> (default)</li><li><code>correctedpedrizzetti</code> is a modification to the pedrizzetti relaxation that preserves the vortex strength magnitude.</li></ul><h3 id="Subfilter-scale-(SFS)-Models"><a class="docs-heading-anchor" href="#Subfilter-scale-(SFS)-Models">Subfilter-scale (SFS) Models</a><a id="Subfilter-scale-(SFS)-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Subfilter-scale-(SFS)-Models" title="Permalink"></a></h3><p>The SFS model is designed to model turbulent diffusion</p><ul><li><code>noSFS</code> (default)</li><li><code>SFS_Cs_nobackscatter</code></li><li><code>SFS_Cd_twolevel_nobackscatter</code> (recommended)</li><li><code>SFS_Cd_threelevel_nobackscatter</code></li></ul><h3 id="Viscous-Schemes"><a class="docs-heading-anchor" href="#Viscous-Schemes">Viscous Schemes</a><a id="Viscous-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Viscous-Schemes" title="Permalink"></a></h3><p>The following schemes are used to simulate fluid viscosity.</p><p>Note: classic VPM often introduces non-physical levels of viscosity to improve numerical stability. The <code>rVPM</code> formulation has been shown to provide sufficient stability without introducing artificial viscosity.</p><ul><li><code>Inviscid</code> (default)</li><li><code>CoreSpreading(nu, sgm0)</code> where <code>nu</code> is kinematic viscosity and <code>sgm0</code> is the core size after reset. This method works by increasing particle size at each time step to account for the viscous effects of the fluid. To keep particles from becoming too large the particle sizes are reset if particle size exceeds a certain threshold that can be set with keyword arguments. <ul><li>Only compatible with <code>gaussianerf</code> kernel</li></ul></li><li><code>ParticleStrengthExchange(nu)</code> where <code>nu</code> is the kinematic viscosity. Uses the diffusion equation to smear the vortex strength over nearby particles.</li></ul><h3 id="Time-Stepping-Schemes"><a class="docs-heading-anchor" href="#Time-Stepping-Schemes">Time Stepping Schemes</a><a id="Time-Stepping-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Stepping-Schemes" title="Permalink"></a></h3><ul><li><code>euler</code> first-order Euler scheme.</li><li><code>rungekutta3</code> third-order Runge-Kutta scheme. (default)</li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 26 June 2025 13:48">Thursday 26 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
